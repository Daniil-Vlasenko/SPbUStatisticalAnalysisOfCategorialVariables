"0","# Построение по вектору численных значений матрицы инцидетности."
"0","numeric.to.binary <- function(column, name) {"
"0","  value <- sort(unique(column))"
"0","  names <- c()"
"0","  for (i in value) {"
"0","    names <- c(names, paste(name, i, sep=""_""))"
"0","  }"
"0","  "
"0","  if (0 %in% value)"
"0","    column <- column + 1"
"0","  "
"0","  matrix.data <- matrix(0, ncol = length(value), nrow = length(column))"
"0","  for (i in 1:length(column)) {"
"0","    matrix.data[i, column[i]] <- 1"
"0","  }"
"0","  "
"0","  df.data <- as.data.frame(matrix.data)"
"0","  colnames(df.data) <- names"
"0","  df.data"
"0","}"
"0",""
"0","# Построение матрицы инцидентности."
"0","df.to.binary <- function(df) {"
"0","  names <- colnames(df)"
"0","  df.data <- numeric.to.binary(as.numeric(unlist(df[, 1])), names[1])"
"0","  for (i in 2:length(names)) {"
"0","    df.data <- cbind(df.data, numeric.to.binary(as.numeric(unlist(df[, i])), names[i]))"
"0","  }"
"0","  df.data"
"0","}"
"0",""
"0","data.new <- df.to.binary(data)"
"0","head(data.new)"
