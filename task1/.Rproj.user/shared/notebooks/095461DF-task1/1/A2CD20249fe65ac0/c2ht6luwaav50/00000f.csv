"0","mean.col <- function(df) {"
"0","  new.df <- df"
"0","  for (i in 1:ncol(df)) {"
"0","    new.df[, i] <- new.df[, i] - mean(df[, i])"
"0","  }"
"0","  return(new.df)"
"0","}"
"0",""
"0","loss.function <- function(X, G, Y) {"
"0","  m <- length(Y)"
"0","  value <- 0"
"0","  for (i in 1:m) {"
"0","    value <- value + tr(t(X - G[[i]] %*% Y[[i]]) %*% (X - G[[i]] %*% Y[[i]]))"
"0","  }"
"0","  return(value)"
"0","}"
"0",""
"0","incidence_matrices <- function(df) {"
"0","  G <- list()"
"0","  for(i in 1:ncol(df)) {"
"0","    G[[i]] <- as.matrix(incidence_matrix(df[,i]))"
"0","  }"
"0","  return(G)"
"0","}"
"0",""
"0","multidim.scaling <- function(df, m) {"
"0","  n <- nrow(df)"
"0","  G <- incidence_matrices(df)"
"0","  "
"0","  X <- matrix(runif(n=n*m, min=1, max=20), nrow=n)"
"0","  X <- mean.col(X)"
"0","  X <- gramSchmidt(X)$Q"
"0","  Y <- list()"
"0","  for(i in 1:m) {"
"0","    Y[[i]] <- inv(t(G[[i]]) %*% G[[i]]) %*% t(G[[i]]) %*% X"
"0","  }"
"0","  "
"0","  for(j in 1:1000) {"
"0","    X <- 0"
"0","    for(i in 1:m) {"
"0","      X <- X + G[[i]] %*% Y[[i]]"
"0","    }"
"0","    X <- mean.col(X)"
"0","    X <- gramSchmidt(X)$Q"
"0","    Y <- list()"
"0","    for(i in 1:m) {"
"0","      Y[[i]] <- inv(t(G[[i]]) %*% G[[i]]) %*% t(G[[i]]) %*% X"
"0","    }"
"0","  }"
"0","  "
"0","  return(X)"
"0","}"
"0",""
"0",""
"0","ms <- multidim.scaling(df.new, 4)"
"0",""
"0",""
