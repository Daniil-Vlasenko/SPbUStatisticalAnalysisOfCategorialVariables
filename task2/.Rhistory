GinyDA.(df3$depressed.mood.1, df3$craving.to.alcohol.1, 2, 2)
GinyDA.(df3$anxiety.1, df3$craving.to.alcohol.1, 2, 2)
GinyDA.(df3$HR.1, df3$craving.to.alcohol.1, 2, 2)
df3 %>% filter(HR.1 > 76.5)
df3 %>% filter(HR.1 < 76.5)
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.1 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.2 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.3 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2, column.3)
class.df
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.1 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 2) %>% nrow())
column.2 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2)
class.df
library(dplyr)
column.03333 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.08333 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 2) %>% nrow())
column.01667 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 2) %>% nrow())
column.11880 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 0:2, column.03333,  column.08333, column.01667, column.11880)
class.df.1
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.1 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 2) %>% nrow())
column.2 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2)
class.df.2
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.1 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 2) %>% nrow())
column.2 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2)
class.df.1
class.df.2
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.1 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 2) %>% nrow())
column.2 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.3 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df2 <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2, column.3)
class.df1
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.1 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 81.5, craving.to.alcohol.1 == 2) %>% nrow())
column.2 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.3 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2, column.3)
class.df.1
class.df.2
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.1 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.2 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.3 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2, column.3)
class.df.1
class.df.2
data <- matrix(c(6, 16, 12, 11), ncol=2)
data
entropy <- function(v) {
sum.v <- sum(v)
p.v <- v / sum.v
entropy.v <- sum(p.v * log2(1 / p.v))
return(entropy.v)
}
H.x <- entropy(apply(data, 1, sum))
H.y <- entropy(apply(data, 2, sum))
paste("H.x:", H.x)
paste("H.y:", H.y)
I <- entropy.x + entropy.y - entropy(as.numeric(data))
entropy <- function(v) {
sum.v <- sum(v)
p.v <- v / sum.v
entropy.v <- sum(p.v * log2(1 / p.v))
return(entropy.v)
}
H.x <- entropy(apply(data, 1, sum))
H.y <- entropy(apply(data, 2, sum))
paste("H.x:", H.x)
paste("H.y:", H.y)
I <- H.x + H.y - entropy(as.numeric(data))
paste("I:", I)
J.x <- I / H.x * 100
J.y <- I / H.y * 100
paste("J.x:", J.x)
paste("J.y:", J.y)
J <- 2 * I / (H.x + H.y) * 100
paste("J:", J)
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
library(dplyr)
library(readxl)
df<-read.csv('data_big.csv')
df
df1<-df[,c('depressed.mood.1','craving.to.alcohol.1','anxiety.1','HR.1')]
df1
df<-read.csv('data_big.csv')
head(df)
df1<-df[,c('depressed.mood.1','craving.to.alcohol.1','anxiety.1','HR.1')]
head(df1)
library("tree")
treeA <- tree(craving.to.alcohol.1 ~., df1)
plot(treeA); text(treeA, col=4) # почему работает через ";", а на разных строках не работает?
# и что это за дерево? ппостроить матрицу классификации для него
# что за дискриминантынй анализ?
library(dplyr)
column.03333 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.08333 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 2) %>% nrow())
column.01667 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 2) %>% nrow())
column.11880 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df <- data_frame(craving.to.alcohol.1 = 0:2, column.03333,  column.08333, column.01667, column.11880)
class.df
##  Тут я решил не переписывать метод классификации и использовал код лекции.
I_inf <-function(X)
{nn <-table(X); n <-sum(nn); n * log(n)- sum(nn * log(nn))}
D_inf <-function(X, Y)I_inf(c(X, Y))- I_inf(X)- I_inf(Y)
GinyDA. <- function(y, class, k1, k2) {
# y независимая переменная, class,
# k1,k2 минимальные объемы подвыборок
ss <- sort(unique(y)); ss
ss. <- (ss[-1] + ss[-length(ss)])/2;
# определяем середины интервалов между наблюдениями
l <- lapply(ss., function(x)
{ L1 <- class[y <= x]; L2 <- class[y > x];
if(length(L1) > k1&length(L2) > k2)
res <- c(D_inf(L1, L2), x)else res <- c(NA, NA) })
# считаем информационные выигрыши при размежевании данных
data.frame(na.omit(do.call("rbind", l)))
}
GinyDA.(df1$depressed.mood.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$anxiety.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$HR.1, df1$craving.to.alcohol.1, 2, 2)
df1 %>% filter(HR.1 < 64.5)
df2 <- df1 %>% filter(HR.1 > 64.5)
GinyDA.(df2$depressed.mood.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$anxiety.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$HR.1, df2$craving.to.alcohol.1, 2, 2)
df2 %>% filter(HR.1 > 81.5)
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.1 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.2 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.3 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2, column.3)
class.df.1
class.df.2
library(dplyr)
column.03333 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.08333 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 2) %>% nrow())
column.01667 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 2) %>% nrow())
column.11880 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 0:2, column.03333,  column.08333, column.01667, column.11880)
class.df.1
column.0 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.1 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.2 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 76.5, craving.to.alcohol.1 == 2) %>% nrow())
column.3 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2, column.3)
class.df.1
class.df.2
GinyDA.(df1$depressed.mood.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$anxiety.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$HR.1, df1$craving.to.alcohol.1, 2, 2)
df1 %>% filter(HR.1 < 81.5)
GinyDA.(df1$depressed.mood.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$anxiety.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$HR.1, df1$craving.to.alcohol.1, 2, 2)
df1 %>% filter(HR.1 > 81.5)
GinyDA.(df1$depressed.mood.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$anxiety.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$HR.1, df1$craving.to.alcohol.1, 2, 2)
df1 %>% filter(HR.1 < 81.5)
GinyDA.(df1$depressed.mood.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$anxiety.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$HR.1, df1$craving.to.alcohol.1, 2, 2)
df1 %>% filter(HR.1 > 81.5)
GinyDA.(df1$depressed.mood.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$anxiety.1, df1$craving.to.alcohol.1, 2, 2)
GinyDA.(df1$HR.1, df1$craving.to.alcohol.1, 2, 2)
df1 %>% filter(HR.1 < 81.5)
df1 %>% filter(HR.1 > 81.5)
df2 <- df1 %>% filter(HR.1 > 81.5)
GinyDA.(df2$depressed.mood.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$anxiety.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$HR.1, df2$craving.to.alcohol.1, 2, 2)
df2 %>% filter(HR.1 > 81.5)
df2 <- df1 %>% filter(HR.1 > 81.5)
GinyDA.(df2$depressed.mood.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$anxiety.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$HR.1, df2$craving.to.alcohol.1, 2, 2)
df2 %>% filter(anxiety.1 < 1.5)
df2 %>% filter(anxiety.1 > 1.5)
df2 <- df1 %>% filter(HR.1 > 81.5)
GinyDA.(df2$depressed.mood.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$anxiety.1, craving.to.alcohol.1, 2, 2)
df2 <- df1 %>% filter(HR.1 > 81.5)
GinyDA.(df2$depressed.mood.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$anxiety.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$HR.1, df2$craving.to.alcohol.1, 2, 2)
df2 %>% filter(anxiety.1 < 1.5)
df2 %>% filter(anxiety.1 > 1.5)
library("tree")
treeA <- tree(depressed.mood.1 ~., df1)
plot(treeA); text(treeA, col=4) # почему работает через ";", а на разных строках не работает?
column.1 <- c(df %>% filter(depressed.mood.1 == 1, craving.to.alcohol.1 > 1.5,
anxiety.1 < 0.5, HR.1 < 66))
column.1
df
library(dplyr)
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & craving.to.alcohol.1 > 1.5 & anxiety.1 < 0.5 & HR.1 < 66.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & craving.to.alcohol.1 > 1.5 & anxiety.1 < 0.5 & HR.1 < 66.5) %>% nrow())
column.1.4 <- c(df %>%
filter(depressed.mood.1 == 1 &
(craving.to.alcohol.1 < 1.5 | craving.to.alcohol.1 > 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow(),
df %>%
filter(depressed.mood.1 == 2 &
(craving.to.alcohol.1 < 1.5 | craving.to.alcohol.1 > 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow())
column.03333 <- c(df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 64.5, craving.to.alcohol.1 == 2) %>% nrow())
column.08333 <- c(df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 64.5, HR.1 < 74, craving.to.alcohol.1 == 2) %>% nrow())
column.01667 <- c(df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 < 81.5, HR.1 > 74, craving.to.alcohol.1 == 2) %>% nrow())
column.11880 <- c(df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 0) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 1) %>% nrow(),
df1 %>% filter(HR.1 > 81.5, craving.to.alcohol.1 == 2) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 0:2, column.03333,  column.08333, column.01667, column.11880)
class.df.1
# column.1
column.1.4
column.1
column.1.4
column.1
column.1
column.1.4
df %>% filter(depressed.mood.1 == 1)
df %>% filter(depressed.mood.1 == 1, craving.to.alcohol.1 > 1.5)
df %>% filter(depressed.mood.1 == 1, craving.to.alcohol.1 > 1.5, anxiety.1 < 0.5)
df %>% filter(depressed.mood.1 == 2, craving.to.alcohol.1 > 1.5, anxiety.1 < 0.5)
df %>% filter(craving.to.alcohol.1 > 1.5, anxiety.1 < 0.5)
ving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow(),
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & craving.to.alcohol.1 > 1.5 & anxiety.1 < 0.5 & HR.1 < 66.5) %>% nrow())
df %>% filter(craving.to.alcohol.1 > 1.5| anxiety.1 < 0.5)
column.1
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 < 66.5) %>% nrow())
column.1.4 <- c(df %>%
filter(depressed.mood.1 == 1 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow(),
df %>%
filter(depressed.mood.1 == 2 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow())
column.1
column.1.4
column.1
column.1.4
library(dplyr)
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 < 66.5) %>% nrow())
column.1.4 <- c(df %>%
filter(depressed.mood.1 == 1 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow(),
df %>%
filter(depressed.mood.1 == 2 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.1.4)
class.df.1
GinyDA.(df1$craving.to.alcohol.1, df1$depressed.mood.1, 2, 2)
GinyDA.(df1$anxiety.1, df1$depressed.mood.1, 2, 2)
GinyDA.(df1$HR.1, df1$depressed.mood.1, 2, 2)
df1 %>% filter(HR.1 < 81.5)
df1 %>% filter(HR.1 > 81.5)
GinyDA.(df1$craving.to.alcohol.1, df1$depressed.mood.1, 2, 2)
GinyDA.(df1$anxiety.1, df1$depressed.mood.1, 2, 2)
GinyDA.(df1$HR.1, df1$depressed.mood.1, 2, 2)
df2 <- df1 %>% filter(anxiety.1 < 1.5); df2
df3 <- df1 %>% filter(anxiety.1 > 1.5); df3
df2 %>% filter(anxiety.1 > 1.5)
GinyDA.(df2$depressed.mood.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$anxiety.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$HR.1, df2$craving.to.alcohol.1, 2, 2)
# df2 %>% filter(anxiety.1 < 1.5)
# df2 %>% filter(anxiety.1 > 1.5)
GinyDA.(df2$depressed.mood.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$anxiety.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$HR.1, df2$craving.to.alcohol.1, 2, 2)
df2 %>% filter(craving.to.alcohol.1 < 64.5)
df2 %>% filter(craving.to.alcohol.1 > 64.5)
GinyDA.(df2$depressed.mood.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$anxiety.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$HR.1, df2$craving.to.alcohol.1, 2, 2)
df2 %>% filter(HR.1 < 64.5)
df2 %>% filter(HR.1 > 64.5)
GinyDA.(df2$depressed.mood.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$anxiety.1, df2$craving.to.alcohol.1, 2, 2)
GinyDA.(df2$HR.1, df2$craving.to.alcohol.1, 2, 2)
df4 <- df2 %>% filter(HR.1 < 64.5); df4
df5 <- df2 %>% filter(HR.1 > 64.5); df5
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 < 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 < 1.5) %>% nrow())
column.2 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 > 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 > 1.5) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.1.4)
class.df.1
library(dplyr)
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 < 66.5) %>% nrow())
column.1.4 <- c(df %>%
filter(depressed.mood.1 == 1 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow(),
df %>%
filter(depressed.mood.1 == 2 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.1.4)
class.df.1
class.df.2 <- data_frame(craving.to.alcohol.1 = 0:2, column.0,  column.1, column.2, column.3)
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 < 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 < 1.5) %>% nrow())
column.2 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 > 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 > 1.5) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.1.4)
class.df.1
class.df.2
library(dplyr)
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 < 66.5) %>% nrow())
column.1.4 <- c(df %>%
filter(depressed.mood.1 == 1 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow(),
df %>%
filter(depressed.mood.1 == 2 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.1.4)
class.df.1
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 < 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 < 1.5) %>% nrow())
column.2 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 > 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 > 1.5) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.1.4)
class.df.1
class.df.2
df %>% nrow()
class.df.1
class.df.2
class.df.2
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 < 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 < 1.5) %>% nrow())
column.2 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 > 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 > 1.5) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.2)
class.df.1
class.df.2
df %>% nrow()
library(dplyr)
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 < 66.5) %>% nrow())
column.1.4 <- c(df %>%
filter(depressed.mood.1 == 1 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow(),
df %>%
filter(depressed.mood.1 == 2 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.1.4)
class.df.1
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 < 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 < 1.5) %>% nrow())
column.2 <- c(df %>% filter(depressed.mood.1 == 1 & anxiety.1 > 1.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & anxiety.1 > 1.5) %>% nrow())
class.df.2 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.2)
class.df.1
class.df.2
df %>% nrow()
df %>% filter(depressed.mood.1 == 1) %>% ncol()
df1 %>% filter(depressed.mood.1 == 1) %>% nrow()
df1 %>% filter(depressed.mood.1 == 1) %>% nrow()
library(dplyr)
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 < 66.5) %>% nrow())
column.1.4 <- c(df %>%
filter(depressed.mood.1 == 1 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow(),
df %>%
filter(depressed.mood.1 == 2 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.1.4)
class.df.1
df1 %>% filter(depressed.mood.1 == 1) %>% nrow()
df1 %>% filter(depressed.mood.1 == 1) %>% nrow()
df1 %>% filter(depressed.mood.1 == 1) %>% nrow()
df1 %>% filter(depressed.mood.1 == 2) %>% nrow()
library(dplyr)
column.1 <- c(df %>% filter(depressed.mood.1 == 1 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow(),
df %>% filter(depressed.mood.1 == 2 & craving.to.alcohol.1 < 1.5 & anxiety.1 > 0.5 & HR.1 > 66.5) %>% nrow())
column.1.4 <- c(df %>%
filter(depressed.mood.1 == 1 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow(),
df %>%
filter(depressed.mood.1 == 2 &
(craving.to.alcohol.1 > 1.5 | craving.to.alcohol.1 < 1.5 &
(anxiety.1 < 0.5 | anxiety.1 > 0.5 & HR.1 < 66.5))) %>% nrow())
class.df.1 <- data_frame(craving.to.alcohol.1 = 1:2, column.1,  column.1.4)
class.df.1
df<-read.csv('data_big.csv')
# df
df1<-df[,c('depressed.mood.1','craving.to.alcohol.1','anxiety.1','HR.1')]
head(df1)
